<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>AniList Anime Player</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  select, button { margin: 10px 0; padding: 8px; }
  #modal {
    display: none;
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.7);
    justify-content: center; align-items: center;
  }
  #modal iframe {
    width: 80%; height: 80%;
  }
  #modalClose {
    position: absolute; top: 20px; right: 30px;
    font-size: 30px; color: white; cursor: pointer;
  }
</style>
</head>
<body>

<h2>Select Anime to Play</h2>

<label for="animeSelect">Anime:</label><br />
<select id="animeSelect">
  <option value="" disabled selected>Select an anime</option>
  <!-- Will be dynamically populated -->
</select><br />

<label for="episodeSelect">Episode:</label><br />
<select id="episodeSelect" disabled>
  <option value="" disabled selected>Select episode</option>
</select><br />

<label for="langSelect">Language:</label><br />
<select id="langSelect" disabled>
  <option value="sub">Sub</option>
  <option value="dub">Dub</option>
</select><br />

<button id="playBtn" disabled>Play</button>

<div id="modal">
  <span id="modalClose">&times;</span>
  <iframe id="playerFrame" src="" frameborder="0" allowfullscreen scrolling="no"></iframe>
</div>

<script>
// Example anime data with episode count and hianime episode IDs
const animeList = [
  {
    name: "My Hero Academia Vigilantes",
    totalEpisodes: 64,
    // Map episode number to hianime-ep-id (normally youâ€™d get these manually)
    episodeMap: {
      1: 123456,
      2: 123457,
      3: 123458,
      // ...
      64: 123519
    }
  },
  {
    name: "Another Anime",
    totalEpisodes: 2,
    episodeMap: {
      1: 987654,
      2: 987655,
    }
  }
];

// References to DOM elements
const animeSelect = document.getElementById("animeSelect");
const episodeSelect = document.getElementById("episodeSelect");
const langSelect = document.getElementById("langSelect");
const playBtn = document.getElementById("playBtn");
const modal = document.getElementById("modal");
const modalClose = document.getElementById("modalClose");
const playerFrame = document.getElementById("playerFrame");

// Populate anime dropdown
animeList.forEach((anime, index) => {
  const opt = document.createElement("option");
  opt.value = index;
  opt.textContent = anime.name;
  animeSelect.appendChild(opt);
});

// When anime is selected
animeSelect.addEventListener("change", () => {
  const selectedAnime = animeList[animeSelect.value];
  episodeSelect.innerHTML = '<option value="" disabled selected>Select episode</option>';
  for(let i=1; i <= selectedAnime.totalEpisodes; i++) {
    const opt = document.createElement("option");
    opt.value = i;
    opt.textContent = `Episode ${i}`;
    episodeSelect.appendChild(opt);
  }
  episodeSelect.disabled = false;
  langSelect.disabled = true;
  playBtn.disabled = true;
});

// When episode selected
episodeSelect.addEventListener("change", () => {
  langSelect.disabled = false;
  playBtn.disabled = true;
});

// When language selected
langSelect.addEventListener("change", () => {
  if (episodeSelect.value && langSelect.value) {
    playBtn.disabled = false;
  }
});

// Play button click
playBtn.addEventListener("click", () => {
  const selectedAnime = animeList[animeSelect.value];
  const episodeNumber = episodeSelect.value;
  const language = langSelect.value;

  const epId = selectedAnime.episodeMap[episodeNumber];
  if(!epId) {
    alert("Episode ID not found. Please add manually.");
    return;
  }

  // Compose embed URL
  const url = `https://megaplay.buzz/stream/s-2/${epId}/${language}`;
  playerFrame.src = url;
  modal.style.display = "flex";
});

// Close modal
modalClose.addEventListener("click", () => {
  modal.style.display = "none";
  playerFrame.src = "";
});
</script>

</body>
</html>
